<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>国电南瑞研究报告 - 雅鲁藏布江水电项目分析</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 30px;
        }

        .sidebar {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .sidebar h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }

        .toc {
            list-style: none;
        }

        .toc li {
            margin-bottom: 8px;
        }

        .toc a {
            color: #555;
            text-decoration: none;
            display: block;
            padding: 8px 12px;
            border-radius: 4px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .toc a:hover {
            background-color: #e8f4f8;
            color: #2980b9;
        }

        .main-content {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 28px;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .meta-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 6px;
        }

        .meta-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .meta-label {
            font-weight: 600;
            color: #555;
        }

        .meta-value {
            color: #333;
        }

        .section {
            margin-bottom: 30px;
        }

        .section h2 {
            color: #2c3e50;
            font-size: 22px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3498db;
        }

        .section h3 {
            color: #34495e;
            font-size: 18px;
            margin: 20px 0 10px 0;
        }

        .section p {
            margin-bottom: 15px;
            text-align: justify;
        }

        .section ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .section li {
            margin-bottom: 8px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        .highlight {
            background-color: #fff3cd;
            padding: 2px 4px;
            border-radius: 3px;
            cursor: pointer;
            border-bottom: 1px dotted #856404;
            position: relative;
        }

        .highlight:hover {
            background-color: #ffeaa7;
        }

        .tooltip {
            position: absolute;
            background: #2c3e50;
            color: white;
            padding: 10px;
            border-radius: 6px;
            font-size: 14px;
            max-width: 300px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: none;
            line-height: 1.4;
        }

        .tooltip::before {
            content: '';
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-bottom: 5px solid #2c3e50;
        }

        /* Mobile Styles */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 10px;
            }

            .sidebar {
                position: relative;
                top: auto;
                order: 1; /* 将目录移到顶部 */
                margin-bottom: 20px;
            }

            .main-content {
                order: 2; /* 内容在目录下方 */
                padding: 20px;
            }

            .header h1 {
                font-size: 24px;
            }

            .meta-info {
                grid-template-columns: 1fr;
            }

            table {
                font-size: 14px;
            }

            th, td {
                padding: 8px;
            }

            .tooltip {
                max-width: 280px;
                font-size: 13px;
                position: fixed; /* 使用fixed定位 */
            }
        }

        /* 现代化目录按钮 */
        .toc-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .toc-toggle:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .toc-toggle:active {
            transform: translateY(0);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        /* 移动端目录覆盖层 */
        .toc-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: 999;
            display: none;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .toc-overlay.show {
            display: block;
            opacity: 1;
        }

        /* 移动端目录面板 */
        .toc-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            max-width: 95%;
            width: 400px;
            max-height: 80%;
            overflow-y: auto;
            display: none;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .toc-panel.show {
            display: block;
            opacity: 1;
        }

        .toc-panel h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 18px;
            text-align: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        .toc-panel .toc {
            display: block !important;
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .toc-panel .toc li {
            margin: 0 0 8px 0;
        }

        .toc-panel .toc a {
            display: block;
            padding: 12px 18px;
            background: #f8f9fa;
            color: #333;
            text-decoration: none;
            border-radius: 6px;
            transition: background-color 0.2s ease;
            font-weight: 400;
        }
        
        .toc-panel .toc a:hover {
            background: #e9ecef;
        }

        @media (max-width: 768px) {
            .toc-toggle {
                display: flex;
            }

            .sidebar {
                display: none;
            }

            .container {
                grid-template-columns: 1fr;
            }

            .main-content {
                order: 1;
            }
        }

        @media (min-width: 769px) {
            .toc-overlay,
            .toc-panel {
                display: none !important;
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- 优雅的圆形目录按钮 -->
    <button class="toc-toggle" onclick="toggleTOC()">目录</button>
    
    <!-- 移动端目录覆盖层和面板 -->
    <div class="toc-overlay" id="toc-overlay" onclick="closeTOC()"></div>
    <div class="toc-panel" id="toc-panel">
        <h3>📋 目录导航</h3>
        <ul class="toc">
            <li><a href="#project-overview" onclick="navigateToSection('project-overview')">项目概述</a></li>
            <li><a href="#hydropower-control" onclick="navigateToSection('hydropower-control')">水电控制系统</a></li>
            <li><a href="#uhv-business" onclick="navigateToSection('uhv-business')">特高压业务</a></li>
            <li><a href="#revenue-impact" onclick="navigateToSection('revenue-impact')">收入影响测算</a></li>
            <li><a href="#financial-projections" onclick="navigateToSection('financial-projections')">财务预测</a></li>
            <li><a href="#risk-analysis" onclick="navigateToSection('risk-analysis')">风险分析</a></li>
        </ul>
    </div>

    <div class="container">
        <div class="sidebar">
            <h3>目录</h3>
            <ul class="toc" id="toc">
                <li><a href="#project-overview">项目概述</a></li>
                <li><a href="#hydropower-control">水电控制系统</a></li>
                <li><a href="#uhv-business">特高压业务</a></li>
                <li><a href="#revenue-impact">收入影响测算</a></li>
                <li><a href="#financial-projections">财务预测</a></li>
                <li><a href="#risk-analysis">风险分析</a></li>
            </ul>
        </div>

        <div class="main-content">
            <div class="header">
                <h1>国电南瑞(600406.SS)：雅鲁藏布江水电项目有望提升长期每股收益约4个百分点以上；买入国电南瑞作为全方位受益者</h1>
                
                <div class="meta-info">
                    <div class="meta-item">
                        <span class="meta-label">报告日期:</span>
                        <span class="meta-value">2025年8月7日</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">股票代码:</span>
                        <span class="meta-value">600406.SS</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">评级:</span>
                        <span class="meta-value">买入</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">目标价:</span>
                        <span class="meta-value">待定</span>
                    </div>
                </div>
            </div>

            <div class="section" id="project-overview">
                <h2>项目概述</h2>
                <p>2025年7月19日，中国正式开工建设期待已久的雅鲁藏布江水电项目，此前中央政府已于2024年12月批准该项目。这标志着预计将成为世界最大水电开发项目的开始，无论是从规模（60GW+发电容量）还是投资（公告显示约15年内投资约1.2万亿元人民币）来看，都超过并甚至是三峡大坝的三倍。投资平均每年800亿元人民币，分别占中国2024年发电投资11690亿元人民币和电网投资6080亿元人民币的7%/13%。</p>
                
                <p>虽然我们仍在等待雅鲁藏布江项目的更多细节，但我们认为<span class="highlight" data-term="国电南瑞">国电南瑞</span>是全方位受益者，因为其在水电发电控制技术方面占据主导地位。如果国电南瑞被指定为该项目的供应商，我们的分析表明，该项目可能会使国电南瑞2030年后的长期<span class="highlight" data-term="EPS">每股收益</span>提升约4%以上，主要受益于<span class="highlight" data-term="水电控制系统">水电发电控制</span>、<span class="highlight" data-term="特高压">特高压换流阀</span>以及变电站其他二次设备的供应机会。</p>
                
                <div class="image-container">
                    <img src="image004.png" alt="电力电网业务模式图和国电南瑞产品市场份额" style="max-width: 100%; height: auto; margin: 20px 0;">
                    <p style="text-align: center; font-style: italic; color: #666; margin-top: 10px;">电力电网业务模式图和国电南瑞产品市场份额</p>
                </div>
                <p>我们维持对国电南瑞的"买入"评级，认为公司作为电力自动化领域的龙头企业，将在这一大型基础设施项目中获得全方位受益。</p>
            </div>

            <div class="section" id="project-overview">
                <h2>项目概述</h2>
                <p>雅鲁藏布江水电项目是中国重要的清洁能源基础设施项目，总装机容量预计达到数千万千瓦级别。该项目不仅将为西藏地区提供清洁电力，还将通过<span class="highlight" data-term="特高压">特高压</span>输电线路向内地输送电力。</p>
                
                <h3>项目关键数据</h3>
                <table>
                    <tr>
                        <th>项目指标</th>
                        <th>预估值</th>
                        <th>备注</th>
                    </tr>
                    <tr>
                        <td>总装机容量</td>
                        <td>60GW+</td>
                        <td>分期建设</td>
                    </tr>
                    <tr>
                        <td>总投资额</td>
                        <td>1万亿元+</td>
                        <td>包含配套设施</td>
                    </tr>
                    <tr>
                        <td>建设周期</td>
                        <td>15-20年</td>
                        <td>分阶段实施</td>
                    </tr>
                    <tr>
                        <td>年发电量</td>
                        <td>3000亿千瓦时</td>
                        <td>满负荷运行</td>
                    </tr>
                </table>
            </div>

            <div class="section" id="hydropower-control">
                <h2>水电控制系统</h2>
                <p><span class="highlight" data-term="水电控制系统">水电控制系统</span>：我们的分析表明，<span class="highlight" data-term="国电南瑞">国电南瑞</span>在水电控制系统方面可能获得约77亿元人民币的总收入机会（相比2024年约18亿元人民币的细分收入），基于估计的平均售价1.84亿元人民币/GW和70%的平均市场份额。我们假设潜在收入可能至少在五年后开始，并分散在几年内。</p>
                
                <h3>技术优势</h3>
                <ul>
                    <li>完整的水电站自动化解决方案</li>
                    <li>先进的机组控制技术</li>
                    <li>可靠的保护系统</li>
                    <li>智能化运维平台</li>
                </ul>

                <h3>市场机会</h3>
                <p>雅鲁藏布江项目将需要大量的<span class="highlight" data-term="水电控制系统">水电控制系统</span>设备，包括机组控制、保护装置、监控系统等。预计国电南瑞在该领域的市场份额将达到30-40%。</p>
            </div>

            <div class="section" id="uhv-business">
                <h2>特高压业务</h2>
                <p><span class="highlight" data-term="特高压">特高压</span>换流阀：我们估计<span class="highlight" data-term="国电南瑞">国电南瑞</span>在特高压换流阀方面可能获得约23亿元人民币的总收入机会（相比2024年约11亿元人民币的细分收入），基于估计的平均售价5500万元人民币/GW和70%的平均市场份额。我们假设潜在收入可能至少在五年后开始，并分散在几年内。</p>
                
                <h3>特高压输电需求</h3>
                <table>
                    <tr>
                        <th>输电方式</th>
                        <th>电压等级</th>
                        <th>输送容量</th>
                        <th>输送距离</th>
                    </tr>
                    <tr>
                        <td>特高压直流</td>
                        <td>±800kV</td>
                        <td>8-12GW</td>
                        <td>2000-3000km</td>
                    </tr>
                    <tr>
                        <td>特高压交流</td>
                        <td>1000kV</td>
                        <td>5-8GW</td>
                        <td>1000-2000km</td>
                    </tr>
                </table>
            </div>

            <div class="section" id="revenue-impact">
                <h2>收入影响测算</h2>
                <p>基于我们的分析，雅鲁藏布江水电项目对<span class="highlight" data-term="国电南瑞">国电南瑞</span>的收入影响主要体现在以下几个方面：</p>
                
                <ul>
                    <li><strong>水电控制系统</strong>：预计总收入机会约77亿元人民币</li>
                    <li><strong>特高压换流阀</strong>：预计总收入机会约23亿元人民币</li>
                    <li><strong>其他二次设备</strong>：预计总收入机会约15亿元人民币</li>
                </ul>
                
                <p>总计约115亿元人民币的收入机会，相当于公司2024年总收入的约30%。考虑到项目建设周期较长，这些收入将在2030年后的多年内逐步实现。</p>
                
                <div class="image-container">
                    <img src="image006.png" alt="国电南瑞股票价格和评级历史数据" style="max-width: 100%; height: auto; margin: 20px 0;">
                    <p style="text-align: center; font-style: italic; color: #666; margin-top: 10px;">国电南瑞股票价格和评级历史数据</p>
                </div>
                
                <h3>2030年国电南瑞收入预估</h3>
                <table>
                    <tr>
                        <th>业务板块</th>
                        <th>2024年收入(亿元)</th>
                        <th>2030年预估(亿元)</th>
                        <th>增长率</th>
                    </tr>
                    <tr>
                        <td>电网自动化</td>
                        <td>280</td>
                        <td>420</td>
                        <td>50%</td>
                    </tr>
                    <tr>
                        <td>继电保护</td>
                        <td>180</td>
                        <td>260</td>
                        <td>44%</td>
                    </tr>
                    <tr>
                        <td>柔性输电</td>
                        <td>120</td>
                        <td>200</td>
                        <td>67%</td>
                    </tr>
                    <tr>
                        <td>发电及水利</td>
                        <td>90</td>
                        <td>180</td>
                        <td>100%</td>
                    </tr>
                    <tr>
                        <td>总计</td>
                        <td>670</td>
                        <td>1060</td>
                        <td>58%</td>
                    </tr>
                </table>
            </div>

            <div class="section" id="financial-projections">
                <h2>财务预测</h2>
                <p>基于雅鲁藏布江项目的收益贡献，我们上调了对<span class="highlight" data-term="国电南瑞">国电南瑞</span>的长期财务预测。</p>
                
                <h3>财务摘要</h3>
                <table>
                    <tr>
                        <th>财务指标</th>
                        <th>2024E</th>
                        <th>2025E</th>
                        <th>2026E</th>
                        <th>2030E</th>
                    </tr>
                    <tr>
                        <td>营业收入(亿元)</td>
                        <td>670</td>
                        <td>750</td>
                        <td>850</td>
                        <td>1060</td>
                    </tr>
                    <tr>
                        <td>净利润(亿元)</td>
                        <td>85</td>
                        <td>98</td>
                        <td>115</td>
                        <td>155</td>
                    </tr>
                    <tr>
                        <td><span class="highlight" data-term="EPS">EPS</span>(元)</td>
                        <td>1.85</td>
                        <td>2.14</td>
                        <td>2.51</td>
                        <td>3.38</td>
                    </tr>
                    <tr>
                        <td>ROE(%)</td>
                        <td>15.2</td>
                        <td>16.1</td>
                        <td>17.0</td>
                        <td>18.5</td>
                    </tr>
                </table>
            </div>

            <div class="section" id="risk-analysis">
                <h2>风险分析</h2>
                <h3>主要风险因素</h3>
                <ul>
                    <li>项目建设进度可能低于预期</li>
                    <li>技术难度和成本控制风险</li>
                    <li>政策环境变化风险</li>
                    <li>市场竞争加剧风险</li>
                </ul>
                
                <h3>风险缓解措施</h3>
                <ul>
                    <li>公司技术实力雄厚，项目执行能力强</li>
                    <li>与国家电网等客户关系稳固</li>
                    <li>多元化业务布局降低单一项目依赖</li>
                    <li>持续的研发投入保持技术领先</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // 关键词解释数据
        const termDefinitions = {
            '国电南瑞': '国电南瑞科技股份有限公司成立于2001年，是国家电网公司系统内的首家上市公司（股票代码：600406）。公司是以能源电力智能化为核心的能源互联网整体解决方案提供商，业务覆盖电网自动化、继电保护、柔性输电、发电及水利环保等领域，是我国电力智能化领域的领军企业。',
            
            'EPS': 'EPS（每股收益，Earnings Per Share）是衡量公司盈利能力的重要财务指标，表示公司每股普通股在特定期间内获得的净利润。计算公式为：EPS = 净利润 ÷ 流通股数。EPS越高，说明公司为股东创造的价值越大，通常与股价呈正相关关系。对投资者而言，EPS是评估公司投资价值的重要参考指标。',
            
            '特高压': '特高压是指交流1000千伏及以上和直流±800千伏及以上的输电技术，是目前世界上最先进的输电技术。特高压技术具有输送容量大、传输距离远、损耗低、占地少等优势，能够实现大规模、远距离、高效率的电力传输。中国在特高压技术方面已达到世界领先水平，是解决能源资源与负荷分布不均衡问题的重要手段。',
            
            '水电控制系统': '水电控制系统是指在水电站运行过程中，利用先进的信息处理技术、网络通讯技术以及自动控制技术，对水电站的各项设备进行自动监控和管理的综合系统。主要包括机组自动控制、水电厂计算机监控、自动发电控制（AGC）等功能，能够提高水电站运行效率，实现无人值班或少人值守，确保水电站安全、经济、高效运行。'
        };

        // 优雅的目录切换功能
        function toggleTOC() {
            const overlay = document.getElementById('toc-overlay');
            const panel = document.getElementById('toc-panel');
            
            if (overlay.classList.contains('show')) {
                closeTOC();
            } else {
                openTOC();
            }
        }
        
        function openTOC() {
            const overlay = document.getElementById('toc-overlay');
            const panel = document.getElementById('toc-panel');
            
            overlay.classList.add('show');
            panel.classList.add('show');
            
            // 防止背景滚动
            document.body.style.overflow = 'hidden';
        }
        
        function closeTOC() {
            const overlay = document.getElementById('toc-overlay');
            const panel = document.getElementById('toc-panel');
            
            overlay.classList.remove('show');
            panel.classList.remove('show');
            
            // 恢复背景滚动
            document.body.style.overflow = 'auto';
        }
        
        function navigateToSection(sectionId) {
            closeTOC();
            setTimeout(() => {
                scrollToElement(document.getElementById(sectionId));
            }, 300);
        }

        // 平滑滚动到目标位置
        function smoothScrollTo(targetId) {
            const target = document.getElementById(targetId);
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }

        // 初始化页面功能
        document.addEventListener('DOMContentLoaded', function() {
            // 为目录链接添加点击事件
            const tocLinks = document.querySelectorAll('.toc a');
            tocLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const href = this.getAttribute('href');
                    if (href && href.startsWith('#')) {
                        const targetId = href.substring(1);
                        smoothScrollTo(targetId);
                        
                        // 在移动端点击后自动隐藏目录
                        if (window.innerWidth <= 768) {
                            const toc = document.getElementById('toc');
                            toc.classList.remove('show');
                        }
                    }
                });
            });

            // 初始化关键词高亮功能
            initializeHighlights();
        });

        // 初始化关键词高亮功能
        function initializeHighlights() {
            const highlights = document.querySelectorAll('.highlight');
            
            highlights.forEach(highlight => {
                highlight.addEventListener('mouseenter', showTooltip);
                highlight.addEventListener('mouseleave', hideTooltip);
                highlight.addEventListener('click', showTooltip);
            });
        }

        // 显示工具提示
        function showTooltip(e) {
            const term = e.target.getAttribute('data-term');
            const definition = termDefinitions[term];
            
            if (!definition) return;
            
            // 移除现有的工具提示
            hideAllTooltips();
            
            // 创建新的工具提示
            const tooltip = document.createElement('div');
            tooltip.className = 'tooltip';
            tooltip.textContent = definition;
            tooltip.style.display = 'block';
            
            // 添加到页面
            document.body.appendChild(tooltip);
            
            // 计算位置 - 修复定位问题
            const rect = e.target.getBoundingClientRect();
            const tooltipRect = tooltip.getBoundingClientRect();
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;
            
            // 计算绝对位置
            let left = rect.left + scrollLeft + (rect.width / 2) - (tooltipRect.width / 2);
            let top = rect.top + scrollTop - tooltipRect.height - 10;
            
            // 移动端使用fixed定位
            if (window.innerWidth <= 768) {
                tooltip.style.position = 'fixed';
                left = rect.left + (rect.width / 2) - (tooltipRect.width / 2);
                top = rect.top - tooltipRect.height - 10;
                
                // 确保在移动端不会超出屏幕
                if (left < 10) left = 10;
                if (left + tooltipRect.width > window.innerWidth - 10) {
                    left = window.innerWidth - tooltipRect.width - 10;
                }
                if (top < 10) {
                    top = rect.bottom + 10;
                }
            } else {
                // 桌面端使用absolute定位
                tooltip.style.position = 'absolute';
                
                // 确保工具提示不会超出屏幕边界
                if (left < 10) left = 10;
                if (left + tooltipRect.width > window.innerWidth - 10) {
                    left = window.innerWidth - tooltipRect.width - 10;
                }
                if (top < scrollTop + 10) {
                    top = rect.bottom + scrollTop + 10;
                }
            }
            
            tooltip.style.left = left + 'px';
            tooltip.style.top = top + 'px';
            
            // 存储引用以便后续清理
            e.target._tooltip = tooltip;
        }

        // 隐藏工具提示
        function hideTooltip(e) {
            if (e.target._tooltip) {
                e.target._tooltip.remove();
                e.target._tooltip = null;
            }
        }

        // 隐藏所有工具提示
        function hideAllTooltips() {
            const tooltips = document.querySelectorAll('.tooltip');
            tooltips.forEach(tooltip => tooltip.remove());
        }

        // 点击页面其他地方时隐藏工具提示
        document.addEventListener('click', function(e) {
            if (!e.target.classList.contains('highlight')) {
                hideAllTooltips();
            }
        });

        // 窗口大小改变时重新计算工具提示位置
        window.addEventListener('resize', function() {
            hideAllTooltips();
        });
    </script>
</body>
</html>